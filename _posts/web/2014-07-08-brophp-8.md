---
layout: post
title: Brophp教程笔记8-Ajax
description: ""
categories: [web]
tags: [php,ajax]
---
#Ajax的应用
##get和post方式：
###get
[./code/test.html]

		<script>
			Ajax().get("demo.php", function(data){
				alert(data);//返回文本数据，字符串
			});
		</script>
		
    //demo.php后面可以跟请求的参数	demo.php?a=10
	Ajax().get("demo.php", function(data){

[./code/demo.php]			

    <?php
        echo "<div>hello</div>";
        echo "<div>mmmm</div>";

test.html中接收到的data='<div>hello</div><div>mmmm</div>'; 

###post
[./code/test.html]

    <script>
			Ajax().post("demo.php", {a:10,b:20},function(data){
				alert(data);
			});
    </script>
    
[./code/demo.php]			

<?php
	echo "{$_POST['a']}-----{$_POST['b']}---test";

结果：data="10-----20---test"

##Ajax()的第一个参数：
###html
Ajax('html')//默认值，即Ajax()默认参数为html.

    Ajax('html').get("demo.php?a=10",function (data){
        alert(data);
    })

返回值： 服务器返回文本字符串

###xml 返回的是xml文档对象
[./code/user.xml]

    <?xml version="1.0" encoding="utf-8"?>
    <users>
        <user>
            <name>1</name>
        </user>	
        <user>
            <name>2</name>
        </user>	
        <user>
            <name>3</name>
        </user>	

    </users>
    
[./code/test.html]

			Ajax('xml').post("user.xml", {a:10,b:20},function(data){
				alert(typeof data);//判断类型
				alert(data.getElementsByTagName('user').length);//由于返回的是xml文档对象，所以可以使用DOM来进行操作。此处是获取user的长度。
			});

返回结果：  //object //3 

###json 返回json对象(适合传递多个数据)

[./code/demo.php]
    
    <?php
        $arr = array("one"=>111,"two"=>"222","three"=>"333","a"=>$_POST['a'],"b"=>$_POST['b']);
        echo json_encode($arr);
    ?>

[./code/test.html]

		<script>
			Ajax('json').post("demo.php", {a:10,b:20},function(data){
				alert(typeof data);//object
				alert(data.one); //111
				alert(data.two); //222
			});
		</script>

##Ajax()的第二个参数：
true (默认值) - 异步ajax
false - 同步ajax 必须等到数据返回之后才继续执行。用在提交表单按钮等。

			Ajax('html', false).get("demo.php", function(data){
				document.getElementById('one').innerHTML=data;	
			});
